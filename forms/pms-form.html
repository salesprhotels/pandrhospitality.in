<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PMS Enquiry | P & R Hospitality</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f4f6fb}
.container{
  max-width:600px;
  margin:40px auto;
  background:#fff;
  padding:25px;
  border-radius:8px;
  box-shadow:0 4px 14px rgba(0,0,0,.1);
}
h1{text-align:center;color:#4b3fd6}
label{display:block;margin-top:14px;font-weight:600}
input,select,textarea{
  width:100%;
  padding:10px;
  margin-top:6px;
  border:1px solid #ccc;
  border-radius:5px;
}
textarea{min-height:90px}
button{
  margin-top:20px;
  width:100%;
  padding:12px;
  background:#f5b400;
  border:none;
  border-radius:6px;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="container">
<h1>PMS Enquiry Form</h1>

<form id="pmsForm">

<label>Full Name</label>
<input type="text" name="fullName" required>

<label>Mobile Number</label>
<input type="tel" name="mobile" required>

<label>Email</label>
<input type="email" name="email">

<label>Property Type</label>
<select name="propertyType">
  <option>Hotel</option>
  <option>Homestay</option>
  <option>Resort</option>
  <option>Guest House</option>
</select>

<label>Room Number</label>
<input type="text" name="roomNumber">

<label>Number of Rooms</label>
<input type="number" name="numberOfRooms">

<label>Required Service</label>
<select name="requiredService">
  <option>PMS Software</option>
  <option>Staff Training</option>
  <option>Website Designing</option>
  <option>Google Business Listing</option>
</select>

<label>Message / Requirement</label>
<textarea name="message"></textarea>

<button type="submit">Submit Enquiry</button>
</form>
</div>

<script>
document.addEventListener("DOMContentLoaded", function(){

  var form = document.getElementById("pmsForm");

  if(!form){
    alert("Form not loaded properly");
    return;
  }

  form.addEventListener("submit", function(e){
    e.preventDefault();

    const data = {
      fullName: form.fullName.value,
      mobile: form.mobile.value,
      email: form.email.value,
      propertyType: form.propertyType.value,
      roomNumber: form.roomNumber.value,
      numberOfRooms: form.numberOfRooms.value,
      requiredService: form.requiredService.value,
      message: form.message.value
    };

    fetch("https://script.google.com/macros/s/AKfycby4bs00-Lr_SGFbHRPG5D-fyOSnnTVynmTwyKrxQo5NxfRhK09fFMEvOJQNTH44_m0_0g/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(resp => {
      if(resp.result === "success"){
        alert("PMS Enquiry submitted successfully");
        form.reset();
      } else {
        alert("Submission failed: " + resp.message);
      }
    })
    .catch(err => {
      alert("Connection error. Please try again.");
      console.error(err);
    });

  });

});
</script>

</body>
</html>
